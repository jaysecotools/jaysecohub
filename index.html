<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CEM Tools Hub — Jay Rowley</title>
<meta name="description" content="A curated hub of ecosystem management learning, planning, simulation and monitoring tools." />
<style>
  :root{
    --bg:#f5f7f9; --card:#ffffff; --accent:#2a7a2a; --muted:#4f5a52; --glass: rgba(255,255,255,0.6);
    --green-600:#2a7a2a; --green-400:#6fcf6f; --blue-500:#2b82b8; --ochre-500:#cf8f2a;
    --gold-500:#ffd54d; --neutral-400:#9aa39b;
    --shadow: 0 10px 26px rgba(6,22,12,0.06);
  }
  [data-theme="dark"]{
    --bg:#0d1110; --card:#0e1612; --accent:#7fcf7f; --muted:#9aa39b; --glass: rgba(255,255,255,0.03);
    --shadow: 0 12px 28px rgba(0,0,0,0.7);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--bg), #e9f1ea 1400px); color:#111; -webkit-font-smoothing:antialiased;
    line-height:1.45;
  }

  header.appbar{
    position:sticky; top:0; z-index:60;
    backdrop-filter: blur(6px);
    background: linear-gradient(90deg, rgba(255,255,255,0.86), rgba(255,255,255,0.22));
    border-bottom: 1px solid rgba(0,0,0,0.04);
    padding:0.6rem 0;
  }
  .inner{ max-width:1200px; margin:auto; display:flex; gap:1rem; align-items:center; padding:0 1rem; }
  .brand{ display:flex; gap:0.9rem; align-items:center; }
  .logo{ width:46px; height:46px; display:grid; place-items:center; border-radius:10px;
    background: radial-gradient(circle at 30% 30%, var(--green-400) 0%, var(--green-600) 60%);
    box-shadow:var(--shadow); flex-shrink:0;
  }
  /* Sparkling pulsing magnifier */
.search svg {
  transition: transform 0.2s ease, filter 0.2s ease;
  fill: var(--muted);
}

.search svg.active {
  animation: sparklePulse 1s infinite alternate;
  filter: drop-shadow(0 0 4px var(--accent));
}

@keyframes sparklePulse {
  0% { transform: scale(1); fill: var(--accent); filter: drop-shadow(0 0 2px var(--accent)); }
  50% { transform: scale(1.12); fill: #8fe38f; filter: drop-shadow(0 0 6px #8fe38f); }
  100% { transform: scale(1.2); fill: var(--accent); filter: drop-shadow(0 0 4px var(--accent)); }
}

  .site-title{ line-height:1; }
  .site-title h1{ font-size:1.05rem; margin:0; color:#123; }
  .site-title p{ margin:0; color:var(--muted); font-size:0.88rem }

  .controls{ margin-left:auto; display:flex; gap:0.6rem; align-items:center }
  .search{ display:flex; align-items:center; gap:0.6rem; background:var(--card); padding:6px 10px; border-radius:10px; box-shadow:var(--shadow) }
  .search svg{ opacity:0.9; transition: transform 0.3s ease; }
  .search svg.active{ transform: scale(1.2); }
  .search input{ border:0; outline:0; min-width:220px; font-size:0.95rem; background:transparent; color:inherit }
  .btn{ background:var(--accent); color:white; padding:8px 10px; border-radius:8px; border:0; cursor:pointer; font-weight:700; font-size:0.9rem }
  .btn.ghost{ background:transparent; color:var(--accent); border:1px solid rgba(0,0,0,0.06) }
  .btn.small{ padding:6px 8px; font-size:0.85rem }

  main{ max-width:1200px; margin:1.25rem auto; padding:0 1rem 3rem }
  .hero{ display:flex; gap:1rem; align-items:center; padding:1.1rem; background:var(--card); border-radius:12px; box-shadow:var(--shadow) }
  .hero h2{ margin:0; font-size:1.25rem }
  .hero p{ margin:0; color:var(--muted) }

  .group{ margin-top:1rem; }
  .group-head{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:0.6rem; cursor:pointer; user-select:none }
  .group-head h3{ margin:0; color:var(--accent); display:flex; align-items:center; gap:0.5rem }
  .group-head h3 .arrow{ display:inline-block; transition: transform 0.3s ease; font-size:0.9rem; }

  .tool-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:0.9rem }
  .card{ background:var(--card); padding:0.9rem; border-radius:12px; box-shadow:var(--shadow);
    border:1px solid rgba(0,0,0,0.03); display:flex; flex-direction:column; gap:0.6rem; min-height:130px;
    transition: transform 160ms ease, box-shadow 160ms ease, opacity 0.25s ease, transform 0.25s ease;
    opacity:1; transform: translateY(0);
  }
  .card:hover{ transform: translateY(-6px); box-shadow: 0 18px 44px rgba(6,22,12,0.12); }
  .card.hidden{ opacity:0; transform: translateY(10px); pointer-events:none; height:0; margin:0; padding:0.45rem 0.9rem; overflow:hidden; }

  .card h4{ margin:0; font-size:1rem; color:var(--accent); display:flex; gap:0.45rem; align-items:center }
  .card .icon{ width:46px; height:46px; display:grid; place-items:center; border-radius:10px; flex-shrink:0; background:#fff; box-shadow: 0 2px 10px rgba(0,0,0,0.04) }
  .meta{ display:flex; gap:0.45rem; align-items:center; flex-wrap:wrap }
  .tag{ background:transparent; color:var(--muted); padding:4px 8px; border-radius:999px; font-size:0.78rem; border:1px dashed rgba(0,0,0,0.03) }
  .desc{ color:var(--muted); font-size:0.92rem }

  .links{ margin-top:auto; display:flex; gap:0.5rem; align-items:center }
  .links a{ flex:1; text-decoration:none; text-align:center; padding:8px 10px; border-radius:8px; background:var(--accent); color:white; font-weight:700 }

  .badge{
    background:linear-gradient(180deg,#fff7df,#ffd54d);
    color:#3c2b00; padding:3px 8px; border-radius:999px; font-size:0.78rem; font-weight:700;
    border:1px solid rgba(0,0,0,0.06);
  }

  .muted{ color:var(--muted); font-size:0.92rem }
  .collapsible{ overflow:hidden; transition:max-height 320ms ease }
  .group-closed .collapsible{ max-height:0 }
  .group-open .collapsible{ max-height:3000px }

  .group-closed .arrow{ transform: rotate(-90deg); }
  .group-open .arrow{ transform: rotate(0deg); }

  footer{ max-width:1200px; margin:1.5rem auto; padding:1rem; color:var(--muted); text-align:center; font-size:0.9rem }

  @media (max-width:720px){
    .search input{ min-width:100px }
    .hero{ flex-direction:column; align-items:flex-start }
  }
</style>
</head>
<body>

<header class="appbar" role="banner">
  <div class="inner">
    <div class="brand" aria-hidden="false">
      <div class="logo" aria-hidden="true">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden>
          <circle cx="12" cy="12" r="11" fill="rgba(255,255,255,0.14)"/>
          <path d="M7 14c2-4 6-6 9-7-1 3-3 6-6 8-1 0-3-1-3-1z" fill="#ffffff" opacity="0.96"/>
        </svg>
      </div>
      <div class="site-title">
        <h1>CEM Tools Hub</h1>
        <p class="lead">Interactive tools for ecosystem learning, planning, simulation and monitoring</p>
      </div>
    </div>

    <div class="controls" role="search" aria-label="Search tools">
      <div class="search" title="Search by name or description">
        <!-- Magnifier SVG -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden>
          <circle cx="11" cy="11" r="7" stroke="#2a7a2a" stroke-width="2" stroke-linecap="round"/>
          <line x1="16.5" y1="16.5" x2="21" y2="21" stroke="#2a7a2a" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <input id="searchBox" placeholder="Search tools (eg. water, biosecurity, simulator)" aria-label="Search tools" />
        <button id="clearSearch" class="btn ghost small" title="Clear search" style="display:none">Clear</button>
      </div>

      <div style="display:flex;gap:0.5rem;align-items:center">
        <button id="openAll" class="btn ghost small" title="Open all sections">Open all</button>
        <button id="closeAll" class="btn ghost small" title="Close all sections">Close all</button>
        <button id="themeToggle" class="btn small" title="Toggle dark mode">Dark</button>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="hero" role="region" aria-label="Introduction">
    <div class="text">
      <h2>Welcome — Jay's Ecosystem Management Suite</h2>
      <p class="muted">Browse by function, search for tools, and open quick-start links. These tools are standalone and classroom-ready for exploration and field learning.</p>
    </div>
  </div>

  <!-- LEARNING -->
  <section class="group group-open" id="group-learning" data-group="learning" aria-labelledby="learning-head">
    <div class="group-head">
      <h3 id="learning-head"><span class="arrow">▾</span> Learning & Reference</h3>
    </div>
    <div class="collapsible">
      <div id="section-learning" class="tool-grid"></div>
    </div>
  </section>

  <!-- SIMULATION -->
  <section class="group group-open" id="group-sim" data-group="sim" aria-labelledby="sim-head">
    <div class="group-head">
      <h3 id="sim-head"><span class="arrow">▾</span> Simulation & Scenario Tools</h3>
    </div>
    <div class="collapsible">
      <div id="section-sim" class="tool-grid"></div>
    </div>
  </section>

  <!-- PLANNING -->
  <section class="group group-open" id="group-planning" data-group="planning" aria-labelledby="planning-head">
    <div class="group-head">
      <h3 id="planning-head"><span class="arrow">▾</span> Project Planning & Management</h3>
    </div>
    <div class="collapsible">
      <div id="section-planning" class="tool-grid"></div>
    </div>
  </section>

  <!-- ASSESSMENT -->
  <section class="group group-open" id="group-assess" data-group="assess" aria-labelledby="assess-head">
    <div class="group-head">
      <h3 id="assess-head"><span class="arrow">▾</span> Assessment & Monitoring</h3>
    </div>
    <div class="collapsible">
      <div id="section-assess" class="tool-grid"></div>
    </div>
  </section>
</main>

<section id="disclaimer" style="max-width:1200px;margin:1.5rem auto;padding:1rem 1.25rem;border-radius:12px;background:var(--card);box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.03)">
  <details open>
    <summary style="cursor:pointer;font-weight:600;color:var(--accent)">Disclaimer</summary>
    <p class="muted" style="margin-top:0.5rem;font-size:0.9rem">
      The tools and resources provided through the CEM Tools Hub are intended for educational use within Conservation and Ecosystem Management training. 
      While every effort has been made to ensure accuracy and reliability, the information and simulations are for learning purposes only and should not be used as a substitute for professional ecological assessment or regulatory advice. 
      Data sources and outcomes may not reflect real-world conditions. Use of these tools is at the user’s discretion.
    </p>
  </details>
</section>
  
<footer>
  <div>Built by Jay Rowley • <a href="mailto:jaysecotools@gmail.com" id="reportFeedback">Send feedback</a></div>
  <div style="margin-top:0.5rem" class="muted">Tip: Press <kbd>/</kbd> to jump to search. Use the filters to narrow tool types.</div>
</footer>

<script>
(async function(){
  const path = 'tools.json';
  let tools = [];
  try{
    const res = await fetch(path);
    if(!res.ok) throw new Error('tools.json fetch failed');
    tools = await res.json();
  }catch(err){
    console.error('Failed to load tools.json:', err);
    ['section-learning','section-sim','section-planning','section-assess'].forEach(id=>{
      const c = document.getElementById(id);
      if(c) c.innerHTML = `<div style="padding:1rem;background:var(--card);border-radius:10px;color:var(--muted)">Could not load tools.json. Check the file is present and the path is correct.</div>`;
    });
    return;
  }

  const iconMap = { default: `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden><rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(154,163,155,0.06)"></rect><rect x="5" y="5" width="14" height="14" rx="2" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--neutral-400') || '#9aa39b'}" stroke-width="1.1"/></svg>` };
  function chooseIcon(tags=[]){ return iconMap.default; }

  function renderTo(containerId, items){
    const container = document.getElementById(containerId);
    if(!container) return;
    container.innerHTML = items.map(item=>{
      const icon = chooseIcon(item.tags || []);
      const badgeHtml = item.badge ? `<span class="badge" style="margin-left:8px">${item.badge}</span>` : '';
      const tagsAttr = (item.tags || []).join(',');
      return `
        <article class="card" data-tags="${tagsAttr}" data-title="${item.title}">
          <div style="display:flex;gap:0.8rem;align-items:flex-start">
            <div class="icon">${icon}</div>
            <div style="flex:1">
              <h4>${item.title} ${badgeHtml}</h4>
              <div class="meta">${(item.tags || []).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
              <p class="desc">${item.desc}</p>
            </div>
          </div>
          <div class="links"><a href="${item.url}" target="_blank" rel="noopener">Open</a></div>
        </article>`;
    }).join('');
  }

  const bySection = tools.reduce((acc,t)=>{ acc[t.section] = acc[t.section] || []; acc[t.section].push(t); return acc; }, {});
  renderTo('section-learning', bySection.learning || []);
  renderTo('section-sim', bySection.sim || []);
  renderTo('section-planning', bySection.planning || []);
  renderTo('section-assess', bySection.assess || []);

  initUI();
})();

function initUI(){
  const themeToggle = document.getElementById('themeToggle'); const root = document.documentElement;
  const saved = localStorage.getItem('jr_theme'); if(saved === 'dark'){ root.setAttribute('data-theme','dark'); themeToggle.textContent='Light'; }
  themeToggle.addEventListener('click', () => {
    if(root.getAttribute('data-theme') === 'dark'){ root.removeAttribute('data-theme'); themeToggle.textContent='Dark'; localStorage.setItem('jr_theme','light') }
    else { root.setAttribute('data-theme','dark'); themeToggle.textContent='Light'; localStorage.setItem('jr_theme','dark') }
  });

  const searchBox = document.getElementById('searchBox');
  const clearBtn = document.getElementById('clearSearch');

  searchBox.addEventListener('input', ()=>{
    const val = searchBox.value.toLowerCase();
    const cards = document.querySelectorAll('.card');
    const magnifier = searchBox.closest('.search').querySelector('svg');

    cards.forEach(c=>{
      const title = c.dataset.title.toLowerCase();
      const tags = (c.dataset.tags||'').toLowerCase();
      if(!val || title.includes(val) || tags.includes(val)){
        c.classList.remove('hidden');
      } else {
        c.classList.add('hidden');
      }
    });

    if(val && magnifier) magnifier.classList.add('active');
    else if(magnifier) magnifier.classList.remove('active');

    clearBtn.style.display = val?'inline-block':'none';
  });

  clearBtn.addEventListener('click', ()=>{
    searchBox.value=''; searchBox.dispatchEvent(new Event('input'));
  });

  document.getElementById('openAll').addEventListener('click', ()=> toggleGroups(true));
  document.getElementById('closeAll').addEventListener('click', ()=> toggleGroups(false));

  document.querySelectorAll('.group-head').forEach(head=>{
    head.addEventListener('click', ()=>{
      const group = head.closest('.group');
      group.classList.toggle('group-open');
      group.classList.toggle('group-closed');
    });
  });
}

function toggleGroups(open=true){
  document.querySelectorAll('.group').forEach(g=>{
    if(open){ g.classList.add('group-open'); g.classList.remove('group-closed'); }
    else { g.classList.remove('group-open'); g.classList.add('group-closed'); }
  });
}

// Shortcut for focusing search
document.addEventListener('keydown', e=>{
  if(e.key === '/') { e.preventDefault(); document.getElementById('searchBox').focus(); }
});
</script>
</body>
</html>
