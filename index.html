<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CEM Tools Hub — Jay Rowley</title>
<meta name="description" content="A curated hub of ecosystem management learning, planning, simulation and monitoring tools." />
<style>
  :root{
    --bg:#f5f7f9; --card:#ffffff; --accent:#2a7a2a; --muted:#4f5a52; --glass: rgba(255,255,255,0.6);
    --green-600:#2a7a2a; --green-400:#6fcf6f; --blue-500:#2b82b8; --ochre-500:#cf8f2a;
    --gold-500:#ffd54d; --neutral-400:#9aa39b;
    --shadow: 0 10px 26px rgba(6,22,12,0.06);
  }
  [data-theme="dark"]{
    --bg:#0d1110; --card:#0e1612; --accent:#7fcf7f; --muted:#9aa39b; --glass: rgba(255,255,255,0.03);
    --shadow: 0 12px 28px rgba(0,0,0,0.7);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--bg), #e9f1ea 1400px); color:#111; -webkit-font-smoothing:antialiased;
    line-height:1.45;
  }

  /* Top bar */
  header.appbar{
    position:sticky; top:0; z-index:60;
    backdrop-filter: blur(6px);
    background: linear-gradient(90deg, rgba(255,255,255,0.86), rgba(255,255,255,0.22));
    border-bottom: 1px solid rgba(0,0,0,0.04);
    padding:0.6rem 0;
  }
  .inner{ max-width:1200px; margin:auto; display:flex; gap:1rem; align-items:center; padding:0 1rem; }
  .brand{ display:flex; gap:0.9rem; align-items:center; }
  .logo{ width:46px; height:46px; display:grid; place-items:center; border-radius:10px;
    background: radial-gradient(circle at 30% 30%, var(--green-400) 0%, var(--green-600) 60%);
    box-shadow:var(--shadow); flex-shrink:0;
  }
  .site-title{ line-height:1; }
  .site-title h1{ font-size:1.05rem; margin:0; color:#123; }
  .site-title p{ margin:0; color:var(--muted); font-size:0.88rem }

  .controls{ margin-left:auto; display:flex; gap:0.6rem; align-items:center }
  .search{ display:flex; align-items:center; gap:0.6rem; background:var(--card); padding:6px 10px; border-radius:10px; box-shadow:var(--shadow) }
  .search svg{ opacity:0.9 }
  .search input{ border:0; outline:0; min-width:220px; font-size:0.95rem; background:transparent; color:inherit }
  .btn{ background:var(--accent); color:white; padding:8px 10px; border-radius:8px; border:0; cursor:pointer; font-weight:700; font-size:0.9rem }
  .btn.ghost{ background:transparent; color:var(--accent); border:1px solid rgba(0,0,0,0.06) }
  .btn.small{ padding:6px 8px; font-size:0.85rem }

  main{ max-width:1200px; margin:1.25rem auto; padding:0 1rem 3rem }
  .hero{ display:flex; gap:1rem; align-items:center; padding:1.1rem; background:var(--card); border-radius:12px; box-shadow:var(--shadow) }
  .hero h2{ margin:0; font-size:1.25rem }
  .hero p{ margin:0; color:var(--muted) }

  .group{ margin-top:1rem; }
  .group-head{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:0.6rem }
  .group-head h3{ margin:0; color:var(--accent) }

  .tool-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:0.9rem }
  .card{ background:var(--card); padding:0.9rem; border-radius:12px; box-shadow:var(--shadow);
    border:1px solid rgba(0,0,0,0.03); display:flex; flex-direction:column; gap:0.6rem; min-height:130px;
    transition: transform 160ms ease, box-shadow 160ms ease;
  }
  .card:hover{ transform: translateY(-6px); box-shadow: 0 18px 44px rgba(6,22,12,0.12); }
  .card h4{ margin:0; font-size:1rem; color:var(--accent); display:flex; gap:0.45rem; align-items:center }
  .card .icon{ width:46px; height:46px; display:grid; place-items:center; border-radius:10px; flex-shrink:0; background:#fff; box-shadow: 0 2px 10px rgba(0,0,0,0.04) }
  .meta{ display:flex; gap:0.45rem; align-items:center; flex-wrap:wrap }
  .tag{ background:transparent; color:var(--muted); padding:4px 8px; border-radius:999px; font-size:0.78rem; border:1px dashed rgba(0,0,0,0.03) }
  .desc{ color:var(--muted); font-size:0.92rem }

  .links{ margin-top:auto; display:flex; gap:0.5rem; align-items:center }
  .links a{ flex:1; text-decoration:none; text-align:center; padding:8px 10px; border-radius:8px; background:var(--accent); color:white; font-weight:700 }

  .badge{
    background:linear-gradient(180deg,#fff7df,#ffd54d);
    color:#3c2b00; padding:3px 8px; border-radius:999px; font-size:0.78rem; font-weight:700;
    border:1px solid rgba(0,0,0,0.06);
  }

  .muted{ color:var(--muted); font-size:0.92rem }
  .collapsible{ overflow:hidden; transition:max-height 320ms ease }
  .group-closed .collapsible{ max-height:0 }
  .group-open .collapsible{ max-height:3000px }

  footer{ max-width:1200px; margin:1.5rem auto; padding:1rem; color:var(--muted); text-align:center; font-size:0.9rem }

  @media (max-width:720px){
    .search input{ min-width:100px }
    .hero{ flex-direction:column; align-items:flex-start }
  }
</style>
</head>
<body>

<header class="appbar" role="banner">
  <div class="inner">
    <div class="brand" aria-hidden="false">
      <div class="logo" aria-hidden="true">
        <!-- leaf-in-circle (brand) -->
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden>
          <circle cx="12" cy="12" r="11" fill="rgba(255,255,255,0.14)"/>
          <path d="M7 14c2-4 6-6 9-7-1 3-3 6-6 8-1 0-3-1-3-1z" fill="#ffffff" opacity="0.96"/>
        </svg>
      </div>
      <div class="site-title">
        <h1>CEM Tools Hub</h1>
        <p class="lead">Interactive tools for ecosystem learning, planning, simulation and monitoring</p>
      </div>
    </div>

    <div class="controls" role="search" aria-label="Search tools">
      <div class="search" title="Search by name or description">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#2a7a2a" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="searchBox" placeholder="Search tools (eg. water, biosecurity, simulator)" aria-label="Search tools" />
        <button id="clearSearch" class="btn ghost small" title="Clear search" style="display:none">Clear</button>
      </div>

      <div style="display:flex;gap:0.5rem;align-items:center">
        <button id="openAll" class="btn ghost small" title="Open all sections">Open all</button>
        <button id="closeAll" class="btn ghost small" title="Close all sections">Close all</button>
        <button id="themeToggle" class="btn small" title="Toggle dark mode">Dark</button>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="hero" role="region" aria-label="Introduction">
    <div class="text">
      <h2>Welcome — Jay's Ecosystem Management Suite</h2>
      <p class="muted">Browse by function, search for tools, and open quick-start links. These tools are standalone and classroom-ready for exploration and field learning.</p>
    </div>

    <!-- Quick Start / Quick Access commented out for now (kept for easy restore)
    <div style="margin-left:auto; display:flex; gap:0.6rem; align-items:center">
      <div class="muted" style="font-size:0.92rem">Featured tools: <span class="badge">Quick start</span></div>
    </div>
    -->
  </div>

  <!-- LEARNING -->
  <section class="group group-open" id="group-learning" data-group="learning" aria-labelledby="learning-head">
    <div class="group-head">
      <h3 id="learning-head">Learning & Reference</h3>
      <div class="group-controls">
        <button data-filter="learning" class="btn ghost small filter-btn">Learning</button>
      </div>
    </div>
    <div class="collapsible">
      <div id="section-learning" class="tool-grid"></div>
    </div>
  </section>

  <!-- SIMULATION -->
  <section class="group group-open" id="group-sim" data-group="sim" aria-labelledby="sim-head">
    <div class="group-head">
      <h3 id="sim-head">Simulation & Scenario Tools</h3>
      <div class="group-controls">
        <button data-filter="simulation" class="btn ghost small filter-btn">Simulation</button>
      </div>
    </div>
    <div class="collapsible">
      <div id="section-sim" class="tool-grid"></div>
    </div>
  </section>

  <!-- PLANNING -->
  <section class="group group-open" id="group-planning" data-group="planning" aria-labelledby="planning-head">
    <div class="group-head">
      <h3 id="planning-head">Project Planning & Management</h3>
      <div class="group-controls">
        <button data-filter="planning" class="btn ghost small filter-btn">Planning</button>
      </div>
    </div>
    <div class="collapsible">
      <div id="section-planning" class="tool-grid"></div>
    </div>
  </section>

  <!-- ASSESSMENT -->
  <section class="group group-open" id="group-assess" data-group="assess" aria-labelledby="assess-head">
    <div class="group-head">
      <h3 id="assess-head">Assessment & Monitoring</h3>
      <div class="group-controls">
        <button data-filter="assessment" class="btn ghost small filter-btn">Assessment</button>
      </div>
    </div>
    <div class="collapsible">
      <div id="section-assess" class="tool-grid"></div>
    </div>
  </section>

</main>

<footer>
  <div>Built by Jay Rowley • <a href="https://github.com/jaysecotools" target="_blank" rel="noopener">GitHub</a> • <a id="reportFeedback" href="#">Send feedback</a></div>
  <div style="margin-top:0.5rem" class="muted">Tip: Press <kbd>/</kbd> to jump to search. Use the filters to narrow tool types.</div>
</footer>

<script>
/* -------------------------
   Load tools.json and render with coloured inline SVG icons
   ------------------------- */
(async function(){
  const path = 'tools.json';
  let tools = [];
  try{
    const res = await fetch(path);
    if(!res.ok) throw new Error('tools.json fetch failed');
    tools = await res.json();
  }catch(err){
    console.error('Failed to load tools.json:', err);
    ['section-learning','section-sim','section-planning','section-assess'].forEach(id=>{
      const c = document.getElementById(id);
      if(c) c.innerHTML = `<div style="padding:1rem;background:var(--card);border-radius:10px;color:var(--muted)">Could not load tools.json. Check the file is present and the path is correct.</div>`;
    });
    return;
  }

  // Coloured SVG icons (inline)
  const iconMap = {
    inspection:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(111,207,111,0.12)"></rect>
         <path d="M11 3h6v6" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
         <path d="M21 21l-6-6" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" stroke-width="1.6" stroke-linecap="round"/>
       </svg>`,

    image:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(43,130,184,0.09)"></rect>
         <rect x="3" y="5" width="18" height="14" rx="2" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--blue-500') || '#2b82b8'}" stroke-width="1.4"/>
         <circle cx="9" cy="11" r="1.6" fill="${getComputedStyle(document.documentElement).getPropertyValue('--blue-500') || '#2b82b8'}"/>
       </svg>`,

    game:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(111,207,111,0.08)"></rect>
         <path d="M12 2l3 7h7l-5.5 4 2 7L12 16 5.5 20l2-7L2 9h7z" fill="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" opacity="0.9"/>
       </svg>`,

    simulation:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(255,213,77,0.07)"></rect>
         <path d="M3 12h18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--gold-500') || '#ffd54d'}" stroke-width="1.6"/>
         <path d="M12 3v18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--gold-500') || '#ffd54d'}" stroke-width="1.6"/>
       </svg>`,

    population:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(207,143,42,0.07)"></rect>
         <circle cx="7" cy="8" r="2" fill="${getComputedStyle(document.documentElement).getPropertyValue('--ochre-500') || '#cf8f2a'}"/>
         <circle cx="17" cy="8" r="2" fill="${getComputedStyle(document.documentElement).getPropertyValue('--ochre-500') || '#cf8f2a'}"/>
         <path d="M2 20c2-6 8-6 10-6s8 0 10 6" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--neutral-400') || '#9aa39b'}" stroke-width="1.2"/>
       </svg>`,

    planner:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(111,207,111,0.06)"></rect>
         <path d="M3 7h18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" stroke-width="1.6"/>
         <path d="M3 12h18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" stroke-width="1.6"/>
         <path d="M3 17h18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--green-600') || '#2a7a2a'}" stroke-width="1.6"/>
       </svg>`,

    dashboard:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(43,130,184,0.06)"></rect>
         <path d="M3 3v18h18" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--blue-500') || '#2b82b8'}" stroke-width="1.2"/>
       </svg>`,

    bio:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(255,213,77,0.06)"></rect>
         <path d="M12 2l7 4v6c0 5-4 9-7 10-3-1-7-5-7-10V6z" fill="${getComputedStyle(document.documentElement).getPropertyValue('--ochre-500') || '#cf8f2a'}" opacity="0.95"/>
       </svg>`,

    water:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(43,130,184,0.08)"></rect>
         <path d="M12 2s4 4 4 7-2 6-4 8-4-4-4-8 4-7 4-7z" fill="${getComputedStyle(document.documentElement).getPropertyValue('--blue-500') || '#2b82b8'}" opacity="0.95"/>
       </svg>`,

    default:
      `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
         <rect x="0" y="0" width="24" height="24" rx="5" fill="rgba(154,163,155,0.06)"></rect>
         <rect x="5" y="5" width="14" height="14" rx="2" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--neutral-400') || '#9aa39b'}" stroke-width="1.1"/>
       </svg>`
  };

  function chooseIcon(tags=[]){
    if(tags.includes('inspection')) return iconMap.inspection;
    if(tags.includes('images')) return iconMap.image;
    if(tags.includes('game')) return iconMap.game;
    if(tags.includes('simulation')) return iconMap.simulation;
    if(tags.includes('population')) return iconMap.population;
    if(tags.includes('planning')) return iconMap.planner;
    if(tags.includes('dashboard')) return iconMap.dashboard;
    if(tags.includes('biosecurity') || tags.includes('bio')) return iconMap.bio;
    if(tags.includes('water')) return iconMap.water;
    return iconMap.default;
  }

  function renderTo(containerId, items){
    const container = document.getElementById(containerId);
    if(!container) return;
    container.innerHTML = items.map(item=>{
      const icon = chooseIcon(item.tags || []);
      const badgeHtml = item.badge ? `<span class="badge" style="margin-left:8px">${item.badge}</span>` : '';
      const tagsAttr = (item.tags || []).join(',');
      return `
        <article class="card" data-tags="${tagsAttr}" data-title="${item.title}">
          <div style="display:flex;gap:0.8rem;align-items:flex-start">
            <div class="icon">${icon}</div>
            <div style="flex:1">
              <h4>${item.title} ${badgeHtml}</h4>
              <div class="meta">${(item.tags || []).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
              <p class="desc">${item.desc}</p>
            </div>
          </div>
          <div class="links"><a href="${item.url}" target="_blank" rel="noopener">Open</a></div>
        </article>`;
    }).join('');
  }

  const bySection = tools.reduce((acc,t)=>{ acc[t.section] = acc[t.section] || []; acc[t.section].push(t); return acc; }, {});
  renderTo('section-learning', bySection.learning || []);
  renderTo('section-sim', bySection.sim || []);
  renderTo('section-planning', bySection.planning || []);
  renderTo('section-assess', bySection.assess || []);

  // initial UI wiring once cards exist
  initUI();
})();

/* -------------------------
   UI & interactions
   ------------------------- */
function initUI(){
  const themeToggle = document.getElementById('themeToggle'); const root = document.documentElement;
  const saved = localStorage.getItem('jr_theme'); if(saved === 'dark'){ root.setAttribute('data-theme','dark'); themeToggle.textContent='Light'; }
  themeToggle.addEventListener('click', () => {
    if(root.getAttribute('data-theme') === 'dark'){ root.removeAttribute('data-theme'); themeToggle.textContent='Dark'; localStorage.setItem('jr_theme','light') }
    else { root.setAttribute('data-theme','dark'); themeToggle.textContent='Light'; localStorage.setItem('jr_theme','dark') }
  });

  const openAll = document.getElementById('openAll'); const closeAll = document.getElementById('closeAll'); const groups = document.querySelectorAll('section.group');
  openAll.addEventListener('click', ()=> groups.forEach(g=> { g.classList.remove('group-closed'); g.classList.add('group-open'); }));
  closeAll.addEventListener('click', ()=> groups.forEach(g=> { g.classList.remove('group-open'); g.classList.add('group-closed'); }));

  const searchBox = document.getElementById('searchBox'); const clearBtn = document.getElementById('clearSearch');
  function normalize(s){ return s?.toString().toLowerCase().trim() }
  function runSearch(q){
    q = normalize(q);
    const cards = Array.from(document.querySelectorAll('.card'));
    cards.forEach(card=>{
      const title = normalize(card.dataset.title || '');
      const desc = normalize(card.querySelector('.desc')?.textContent || '');
      const tags = normalize(card.dataset.tags || '');
      const match = q === '' || title.includes(q) || desc.includes(q) || tags.includes(q);
      card.style.display = match ? '' : 'none';
    });
    clearBtn.style.display = q? 'inline-block':'none';
  }
  searchBox.addEventListener('input', e => runSearch(e.target.value));
  clearBtn.addEventListener('click', ()=>{ searchBox.value=''; runSearch(''); searchBox.focus(); });

  const filterBtns = Array.from(document.querySelectorAll('.filter-btn'));
  filterBtns.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const filter = btn.dataset.filter;
      const allCards = Array.from(document.querySelectorAll('.card'));
      allCards.forEach(c=>{
        if(filter==='all'){ c.style.display = '' }
        else { c.style.display = c.dataset.tags.includes(filter) ? '' : 'none'; }
      });
    });
  });

  window.addEventListener('keydown', (e)=>{
    if(e.key === '/' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA'){ e.preventDefault(); document.getElementById('searchBox').focus(); }
  });

  const fb = document.getElementById('reportFeedback'); if(fb) fb.addEventListener('click', (e)=>{ e.preventDefault();
    const subject = encodeURIComponent('CEM Tools Hub feedback');
    const body = encodeURIComponent('Hi Jay,%0D%0A%0D%0AFeedback about the CEM Tools Hub:%0D%0A%0D%0A(Please paste your feedback here)%0D%0A%0D%0APage: ' + location.href);
    window.location.href = `mailto:jay@example.com?subject=${subject}&body=${body}`;
  });
}
</script>
</body>
</html>
